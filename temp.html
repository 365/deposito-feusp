/** ============================================
         CALCULA FORMATO TESE (coluna I)
        ============================================ */
    function calcularFormatoTese() {
        const radios = [];  // Pega 10 radios (5 tit + 5 supl)
        for (let i = 1; i <= 5; i++) {
            radios.push(`part${i}Presencial`, `part${i}Distancia`);
        }
        
        let presencialCount = 0;
        let totalMarcados = 0;
        
        radios.forEach(id => {
            const radio = document.getElementById(id);
            if (radio && radio.checked) {
                totalMarcados++;
                if (radio.value === 'Presencial') presencialCount++;
            }
        });
        
        if (totalMarcados === 0) return '';  // Nenhum marcado
        
        if (presencialCount === totalMarcados) return 'Presencial';
        if (presencialCount === 0) return 'Virtual';
        return 'H√≠brido';  // Mistura
    }



    /** =============================
     ETAPA 3 ‚Üí ETAPA 4 (FINAL)
    ============================= */
    document.addEventListener('DOMContentLoaded', function() {
    const btnStep4 = document.getElementById('btn-proximo-etapa3');

    if (btnStep4) {
        btnStep4.addEventListener('click', function() {
        console.log('üî• CLIQUE step-4');
        //document.getElementById('step-3').classList.add('d-none');
        //document.getElementById('step-4').classList.remove('d-none');
        mostrarEtapa(4);

        const dados = window.dadosAluno || {};
        
        // ESPERA DOM step-4 renderizar
        setTimeout(() => {
            console.log('‚è≥ RESUMO ap√≥s render');
            document.getElementById('resumoNome').textContent = dados.nome || '-';
            document.getElementById('resumoNrUsp').textContent = dados.nrUsp || '-';
            document.getElementById('resumoEmail').textContent = dados.emailUSP || '-';
            document.getElementById('resumoTitulo').textContent = dados.tituloTese || '-';
            console.log('‚úÖ TELA:', document.getElementById('resumoNome').textContent);
        }, 300);  // 300ms espera Bootstrap render

        // O setTimeout garante que o HTML j√° apareceu antes de tentar escrever nele
        setTimeout(() => {
            atualizarResumoFinal(); 
        }, 100);
        
        document.getElementById('progress-bar').style.width = '75%';
        
        // SCROLL
        setTimeout(() => {
            document.getElementById('form-container').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 200);
        
        console.log('‚úÖ STEP-4 CARREGADA');
        });
        console.log('Evento step-4 ATIVO!');
    } else {
        console.error('BOT√ÉO step-4 N√ÉO ENCONTRADO!');
    }
    });



    /** ============================================
     Exibindo a ETAPA 4 - Upload da tese
    ============================================ */
    function mostrarEtapa4() {
        // Esconde a etapa anterior e mostra a 4
        //document.getElementById('step-3').style.display = 'none';
        //document.getElementById('step-4').style.display = 'block';
        mostrarEtapa(4);

        // Puxa os valores dos inputs das etapas anteriores
        document.getElementById('resumoNome').innerText = document.getElementById('nome').value || "N√£o preenchido";
        document.getElementById('resumoNrUsp').innerText = document.getElementById('nrUsp').value || "N√£o preenchido";
        document.getElementById('resumoEmail').innerText = document.getElementById('emailUSP').value || "N√£o preenchido";
        document.getElementById('resumoTitulo').innerText = document.getElementById('tituloTese').value || "N√£o preenchido";

        progressBar.style.width = '75%'; // <--- Etapa 4 mostra 75%
        
        // Atualiza a barra de progresso (se voc√™ estiver usando uma)
        //updateProgressBar(100); 
    }